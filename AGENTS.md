# AGENTS

## 文字コードルール（Windows / PowerShell）

- Markdown / テキストファイルは `UTF-8` を前提に扱う
- `PowerShell` で読み書きする場合は、文字コードを明示する
- `Get-Content` / `Set-Content` / `Out-File` を使うときは `UTF-8` 指定を省略しない
- 文字化けしやすいファイル（`CHANGELOG.md`, `ROADMAP.md`, `docs/*.md`）は `apply_patch` を優先する

## PowerShell 実行時の実務ルール

- 読み込み: `Get-Content -Encoding UTF8`
- 書き込み: `Set-Content -Encoding utf8`
- .NET API で書く場合は `UTF8Encoding($false)` を使い、BOM有無を明示する

## 追記・置換の注意

- 文字化けした表示を見たまま置換しない（意図しない差分が出やすい）
- 大きいテキスト置換をする前に `git diff --stat` で差分量を確認する
- 不自然に差分が大きい場合は作業を止めて、エンコード起因を疑う

# ROADMAP 運用ルール（Codex向け）

## 基本方針

- ROADMAP には「進行中」と「予定」のみ記載する
- 完了した項目は **即削除**し、CHANGELOG に移す
- 詳細は CHANGELOG に書く。ROADMAP には書かない

---

## 記述ルール

### 1. 1項目は1行で書く

- 説明・補足・経緯は ROADMAP には書かない
- 詳細が必要なら CHANGELOG に書き、ROADMAP からは参照しない

**NG例:**
```
- サムネイル保存管理の再設計（Step 2 追加）: 書庫サムネイルを優先 WebP 保存へ変更し、
  容量削減と形式の一貫性を改善（変換失敗時は元形式フォールバック）
```

**OK例:**
```
- サムネイル保存管理 Step 2: 書庫サムネイル WebP 化（進行中）
```

---

### 2. 項目数の上限を守る

| セクション | 上限 |
|-----------|------|
| 進行中    | 5項目 |
| 予定（直近）| 5項目 |
| 予定（将来候補）| 10項目 |

- 上限を超える場合は、完了済みを削除するか Backlog に送る
- 上限を超えてでも追記することは禁止

---

### 3. 完了したら即削除する

- 「完了」「実質完了」「確認済み」になった項目は ROADMAP から削除し、CHANGELOG に移す
- 「完了欄」「最近完了した項目」のような保管セクションを ROADMAP に作らない
- ROADMAP と CHANGELOG の両方に同じ内容を書かない

---

### 4. 「進行中」セクションのルール

- 現在アクティブに作業している項目のみ記載する
- 作業が止まっている・保留中の項目は「予定」か Backlog に移す
- セッション開始時に「進行中」を確認し、完了済みは即削除すること

---

## セクション構成（テンプレート）

```markdown
## 進行中 (In Progress)
- [タスク名]: [一言で状態]
- ...（最大5項目）

## 予定 (Planned)
### 直近
- [タスク名]
- ...（最大5項目）

### 将来候補
- [タスク名]（コスト: 低/中/高、リスク: 低/中/高）
- ...（最大10項目）

## Backlog
- [タスク名]
```

---

## Codex がセッション終了時にやること

1. 完了した進行中タスクを ROADMAP から削除し CHANGELOG に追記する
2. 新たに着手したタスクを「進行中」に追加する（1行で）
3. 各セクションが上限を超えていないか確認する
4. ROADMAP と CHANGELOG で内容が重複していないか確認する
