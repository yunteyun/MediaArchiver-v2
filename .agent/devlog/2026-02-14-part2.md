# Development Log - 2026-02-14 (Part 2)

## Phase 18-C: File Operations (Move to Folder)

### 目的
右クリックメニューから登録済みフォルダへファイルを移動する機能を追加する。これにより、アプリ内でのファイル整理が可能になる。

### 実装詳細

#### 1. バックエンド (`fileOperationService.ts`)
- `moveFileToFolder` 関数を実装。
- **Cross-Device Move対応**:
  - `fs.rename` は同一ドライブ内でしか動作しないため、異なるドライブ間（例: D: -> C:）の移動では `EXDEV` エラーが発生する。
  - `rename` 失敗時にエラーコード `EXDEV` を検出し、`copyFile` + `unlink` (コピーして削除) にフォールバックするロジックを実装。
- 移動先に同名ファイルが存在する場合はエラーを返す（上書き防止）。

#### 2. IPC & Menu (`file.ts`)
- `file:moveToFolder` IPC ハンドラを追加。
- `file:showContextMenu` に「フォルダに移動」サブメニューを追加。登録済みフォルダ一覧を動的に生成。

#### 3. フロントエンド (`FileCard.tsx`, `preload.ts`)
- トースト通知による結果表示（成功/失敗）。
- `electron.d.ts` に型定義追加。

### 学んだこと
- **Electron/Node.js**: `fs.rename` の `EXDEV` 制約はクロスプラットフォーム開発で忘れがちだが重要。Windows環境ではドライブ間の移動で必ず発生する。
- **UX**: ファイル移動のような破壊的操作は、成功/失敗のフィードバックが重要。トースト通知で十分に機能した。

### Next Steps
- Release Preparation (electron-builder setup)
